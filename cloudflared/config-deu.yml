# Cloudflare Tunnel Configuration for DIVE V3 - DEU Instance (Germany)
# Remote Deployment at prosecurity.biz

tunnel: 2856308e-2467-495d-b735-6f588140c387
credentials-file: /etc/cloudflared/tunnel-credentials.json

# Force HTTP/2 to avoid QUIC timeout issues on restricted networks
protocol: http2

# Metrics for monitoring
metrics: 0.0.0.0:9126

ingress:
  # DEU Frontend (Next.js) - CRITICAL: Use Docker service name with -deu suffix
  - hostname: deu-app.dive25.com
    service: https://frontend-deu:3000
    originRequest:
      noTLSVerify: true
      connectTimeout: 60s

  # DEU Backend API - CRITICAL: Use Docker service name with -deu suffix
  - hostname: deu-api.dive25.com
    service: https://backend-deu:4000
    originRequest:
      noTLSVerify: true
      connectTimeout: 60s

  # DEU Keycloak IdP - CRITICAL: Use Docker service name with -deu suffix
  - hostname: deu-idp.dive25.com
    service: https://keycloak-deu:8443
    originRequest:
      noTLSVerify: true
      connectTimeout: 60s

  # DEU KAS - CRITICAL: Use Docker service name with -deu suffix
  - hostname: deu-kas.dive25.com
    service: http://kas-deu:8080
    originRequest:
      connectTimeout: 60s

  # Catch-all rule (required)
  - service: http_status:404

