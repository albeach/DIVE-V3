# Cloudflare Tunnel Configuration for DIVE V3 - DEU Instance (Germany)
# Remote Deployment at prosecurity.biz

tunnel: 2856308e-2467-495d-b735-6f588140c387
credentials-file: /etc/cloudflared/tunnel-credentials.json

# Force HTTP/2 to avoid QUIC timeout issues on restricted networks
protocol: http2

# Metrics for monitoring
metrics: 0.0.0.0:9126

ingress:
  # DEU Frontend (Next.js) - Use network alias for docker compose v2
  - hostname: deu-app.prosecurity.biz
    service: http://frontend-deu:3000
    originRequest:
      noTLSVerify: true
      connectTimeout: 60s

  # DEU Backend API - Use network alias for docker compose v2
  - hostname: deu-api.prosecurity.biz
    service: http://backend-deu:4000
    originRequest:
      noTLSVerify: true
      connectTimeout: 60s

  # DEU Keycloak IdP - Use network alias for docker compose v2
  - hostname: deu-idp.prosecurity.biz
    service: https://keycloak-deu:8443
    originRequest:
      noTLSVerify: true
      connectTimeout: 60s

  # DEU KAS - Use network alias for docker compose v2
  - hostname: deu-kas.prosecurity.biz
    service: http://kas-deu:8080
    originRequest:
      connectTimeout: 60s

  # Catch-all rule (required)
  - service: http_status:404

