# ============================================
# DIVE V3 KAS Configuration (ACP-240 Compliant)
# ============================================

# Server Configuration
KAS_PORT=8080
HTTPS_ENABLED=true
NODE_ENV=development

# Feature Flags
ENABLE_REWRAP_PROTOCOL=false
ENABLE_FEDERATION=true
ENABLE_DPOP=false

# Keycloak Configuration
KEYCLOAK_URL=https://localhost:8443
KEYCLOAK_REALM=dive-v3-broker
KEYCLOAK_CLIENT_ID=dive-v3-client

# OPA Configuration
OPA_URL=https://localhost:8181
OPA_POLICY_PATH=/v1/data/dive/authorization/decision

# Backend Configuration
BACKEND_URL=https://localhost:4000

# HSM Provider Configuration
# Options: mock | aws-kms | azure-hsm | pkcs11
KAS_HSM_PROVIDER=mock

# AWS KMS Configuration (if using aws-kms provider)
# AWS_REGION=us-east-1
# AWS_KMS_KEY_ID=alias/dive-v3-kas-kek

# Azure HSM Configuration (if using azure-hsm provider)
# AZURE_KEY_VAULT_NAME=dive-v3-vault
# AZURE_KEY_VAULT_KEY_NAME=kas-kek

# Key Management
KAS_KEK_ID=mock-kek-001
KAS_KEY_ROTATION_DAYS=90

# DPoP Configuration
DPOP_PROOF_MAX_AGE=60
DPOP_NONCE_CACHE_SIZE=10000
DPOP_NONCE_TTL=300

# PolicyBinding Configuration
POLICY_BINDING_ALGORITHM=sha256

# Cryptography Configuration
KAS_WRAP_ALGORITHM=RSA-OAEP-256
KAS_SIGNING_ALGORITHM=RS256
KAS_SUPPORTED_ALGORITHMS=RS256,RS512,ES256,ES384,PS256

# Performance Configuration
DEK_CACHE_TTL=3600
JWKS_CACHE_TTL=3600
OPA_DECISION_CACHE_TTL=60

# Federation Configuration
FEDERATION_TIMEOUT_MS=5000
FEDERATION_MAX_RETRIES=3
FEDERATION_CIRCUIT_BREAKER_THRESHOLD=5
FEDERATION_CIRCUIT_BREAKER_TIMEOUT=30000

# Security Configuration
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
REQUEST_SIZE_LIMIT=10mb

# Logging Configuration
LOG_LEVEL=info
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=./logs/kas-audit.log

# Monitoring Configuration
METRICS_ENABLED=true
METRICS_PORT=9090

# TLS Configuration
TLS_CERT_PATH=../certs/server/localhost.crt
TLS_KEY_PATH=../certs/server/localhost.key
TLS_CA_PATH=../certs/ca/root-ca.crt
