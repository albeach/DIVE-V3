[
  {
    "resourceId": "doc-generated-1762442084102-0009",
    "title": "Joint Exercise - Air Superiority 9",
    "classification": "TOP_SECRET",
    "releasabilityTo": [
      "USA",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Beta"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "E6HoMtjUPAGHdFkJ",
      "authTagBase64": "8gta2WXwU+c8x3PaNjeWMQ==",
      "encryptedContentBase64": "2BhjYyNKm0WRhf/j6+AI89yVirWlzohwAGLxRH8JP7q6+VXV//omYPJQwpyCi3he2TunmhMWCh2j/XqQ2tfuEzADPD3AZ1gS2vaim7n5DLPcbQ5ClSrDAOm1bxEuBuNUkbtUhBRJltipoPeTtY7aqFDB3MwRzQpceU8tGJWQins/a+VdoiKVVeOwUbjfY8UaCXZfEopGLx6JHpDhlJbyTify55+YQoe0dTQsSIVN4SA8JCtmqL/WQCV/iHYuz5/MPs8oJwNARaHFQxr0Nu2QVZFkMj2yTXR4yGSKzFRcxgSLWuXlM5YxTXq3A306H+bVUhAOAl1snGEmAvhKT1m4T6ahoLMTObh0TUMEbGl5PnRkXFXu2IlFSxS+JIb8jzTpxWAz5x2rMgp3yOSDKWu3bg26cE1hYsDFjSPlqyhMi426GrH0CjA4R2BWiC6KlHp+IA089ByzxkA0FjFg/PhVEl66wRVV3E4QtTYuGKMs8OWjCbGfIbKAsbUe+h6AnXoEt6EaumjpTZzsO/gsrDU=",
      "encryptedContentSize": 398,
      "coi": "Beta"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Beta\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Beta), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Beta')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: E6HoMtjUPAGHdFkJ\n  Hex: 13a1e832d8d43c0187745909\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: 8gta2WXwU+c8x3PaNjeWMQ==\n  Hex: f20b5ad965f053e73cc773da36379631\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Beta')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Beta');\n  const iv = Buffer.from('E6HoMtjUPAGHdFkJ', 'base64');\n  const authTag = Buffer.from('8gta2WXwU+c8x3PaNjeWMQ==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Beta')  # 32 bytes\n  iv = base64.b64decode('E6HoMtjUPAGHdFkJ')\n  auth_tag = base64.b64decode('8gta2WXwU+c8x3PaNjeWMQ==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084102-0009",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.576Z",
      "displayMarking": "TOP_SECRET//Beta//REL USA, FRA, DEU"
    }
  },
  {
    "resourceId": "doc-generated-1762442084104-0094",
    "title": "Maritime Operations - Eastern Border 94",
    "classification": "TOP_SECRET",
    "releasabilityTo": [
      "USA",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Beta"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "CrdCQm6TNa3TEPvm",
      "authTagBase64": "2GAdUXq/2plaBsUGfrEE0Q==",
      "encryptedContentBase64": "GmDtBY5GznaaXc7EzRf6JVms0lncXZuvkFfwMKvIkMfPBG3GMe5PBGCktRW2y5nwMKq7uBwn9iWONRb+a3ibMceagc0e1QxNuMkmve3cHCMPmkvW2D9G9+PfdPI5h1jcOKR6M+EEAcU5Jj1pep+rLhlbH9dTbpIRD3VD8FOAk+j7eqxg0Z8rHz4Deko6ceASYJjrCC8ygzp8rz+kOhA4o+fYKY3Rt5hy1HFyTlUSE61mPdJ4kfGIx34SVVj/+A8NquLcE/6TYa7rZa4lNISAWGu2FriszWfDLY6Xdj78Sg1KItmY0wPA/dgfXFAyDF8QbKJNJWksXHaE8+9oA9kqrp8rsQwcB1h9FS6VoKqjJOA0PapNUCvnIBm1SaH3fmBaLZCacXc7A2OTyH8XFQnqYF0P+MAqelnVmCLNsD4bW0gdtlma8xsMQuuhet8mtyJ4l9CelhxhL8wvEfihyalwsJ1GdQwiu8XpEVlFwenVCzNPKsM752MWcxA+ikaqZphI/3lnIL6UTltxAtNMRZaL0TvJZg==",
      "encryptedContentSize": 403,
      "coi": "Beta"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Beta\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Beta), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Beta')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: CrdCQm6TNa3TEPvm\n  Hex: 0ab742426e9335add310fbe6\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: 2GAdUXq/2plaBsUGfrEE0Q==\n  Hex: d8601d517abfda995a06c5067eb104d1\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Beta')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Beta');\n  const iv = Buffer.from('CrdCQm6TNa3TEPvm', 'base64');\n  const authTag = Buffer.from('2GAdUXq/2plaBsUGfrEE0Q==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Beta')  # 32 bytes\n  iv = base64.b64decode('CrdCQm6TNa3TEPvm')\n  auth_tag = base64.b64decode('2GAdUXq/2plaBsUGfrEE0Q==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084104-0094",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.577Z",
      "displayMarking": "TOP_SECRET//Beta//REL USA, FRA, DEU"
    }
  },
  {
    "resourceId": "doc-generated-1762442084611-0116",
    "title": "Training Manual - Mediterranean 116",
    "classification": "TOP_SECRET",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN"
    ],
    "COI": [
      "Alpha"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "j4PJ0OBMtvyT0hOv",
      "authTagBase64": "tptsk/oJiyuvpXvIYPOeiQ==",
      "encryptedContentBase64": "+s+D/7hzPRRhZs5hVj7SFfArHnNfiMMs+O/qwrEveaAiyJCGHwZ3XCHTD0rYu+mi8F2rdH1MnVEXKRhCHL40UD7Vm7UKL7XqF2SfZoqu9StEGWDh27FyPpteQEzoRMhzyDWOKLHsCPYu/lp2Br9WALaizycWyMx7YT3mYX0k/WCCjlPBjddszwWauBAyORZiMePk4/2fYby6vy/tuSImmf8uj5zDMeqYu2798VV8pc1GRzA4B5p7RbSEk38XqoqJQSojDj9mHEzoK1WOS9V8lmM4p9AUfXf5pB+oRX/kw3BAmJgrWX0iVcqPT9l68Rs+Wcz8eKEwonh5x/FsWcH+vjtxq4RdSQOOYhFZWtZHOlY0TA8gHDEoBUv8MXsp2s/1vceIsE4Kxf/dtU2HtD8+uax2C4FCqbWWSL6eXPF1uNlrYs5g7vqRphGbBF6HXEqNnd8XCmMP0IuAZFHj953GL8HchVIlxcoAPaCMnU7Spra0G297dpxa1GWrVX1m0Sfsri0gnNaabnJ7bVooCRchS/M=",
      "encryptedContentSize": 401,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: j4PJ0OBMtvyT0hOv\n  Hex: 8f83c9d0e04cb6fc93d213af\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: tptsk/oJiyuvpXvIYPOeiQ==\n  Hex: b69b6c93fa098b2bafa57bc860f39e89\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('j4PJ0OBMtvyT0hOv', 'base64');\n  const authTag = Buffer.from('tptsk/oJiyuvpXvIYPOeiQ==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('j4PJ0OBMtvyT0hOv')\n  auth_tag = base64.b64decode('tptsk/oJiyuvpXvIYPOeiQ==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084611-0116",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.965Z",
      "displayMarking": "TOP_SECRET//Alpha//REL USA, GBR, CAN"
    }
  },
  {
    "resourceId": "doc-generated-1762442084612-0149",
    "title": "Coalition Strategy - North Atlantic 149",
    "classification": "TOP_SECRET",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN"
    ],
    "COI": [
      "Alpha"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "RYSSyI9scOItgnjo",
      "authTagBase64": "T0jUv/u/iV9v6XbJbUNbyQ==",
      "encryptedContentBase64": "y+2NhIkgQXvVSYEc2ogkgwHTCeW7D49i3BSr6rGSY5qsigW3J1RVUuTd1ksgEFrXrzU3AuJKVeRQH8N5NXFvggd9iEQogSqVAWc3DFtcH4WiJXS6T4fMKuEKkxuofPrrayO7ql5desnnwF+xMB4/8urvLpO517VPxDf8y1kzk4UOCU32hpZUQueM9mV67aoJ8VvyXHdhJeJoSBYoRlQDPbbagcbXCadR1lG1YxWBg5mR1Yi9fSXo7YQqd7oWaBMowGuxorWy25ucpo+TLq0Ii6nxALUUoMNZfQq2A5HqlohyGObSDdk5BNlKPZqw43qRf/jIjXCZw7pP8v3Jpu2J6oPURCRcE2AZNTKBaev0sVcCdNuBNi93B0jX3SU68oGPgMX31OPZLQP9nRu+j6j281IrJvvf+F/j2JIeQ7RpDWEEhM/OhixaqI7mUQ+aKyyNNS0iifIOKD+DW2f4e2Axdy7DRakrzz8+KGSgbW7I4/y7/MQBuZWp8z0CzF3f6sSXa7rCXJZGdy8H8PYho+OGze8EzLXO",
      "encryptedContentSize": 405,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: RYSSyI9scOItgnjo\n  Hex: 458492c88f6c70e22d8278e8\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: T0jUv/u/iV9v6XbJbUNbyQ==\n  Hex: 4f48d4bffbbf895f6fe976c96d435bc9\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('RYSSyI9scOItgnjo', 'base64');\n  const authTag = Buffer.from('T0jUv/u/iV9v6XbJbUNbyQ==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('RYSSyI9scOItgnjo')\n  auth_tag = base64.b64decode('T0jUv/u/iV9v6XbJbUNbyQ==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084612-0149",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.969Z",
      "displayMarking": "TOP_SECRET//Alpha//REL USA, GBR, CAN"
    }
  },
  {
    "resourceId": "doc-generated-1762442084612-0155",
    "title": "Air Defense - Eastern Border 155",
    "classification": "TOP_SECRET",
    "releasabilityTo": [
      "USA",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Beta"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "jJmM1SU6RWqYXlt3",
      "authTagBase64": "VQmb3aJ0ItLsGdRhX8VIrg==",
      "encryptedContentBase64": "tqe4nfx17Z1mf6bp/KooYtVTB8hKRNfiR+x3/85L0NahUAPNchncNl0M5Gx1rvuPSVrGMFRzKHgpUSgIToZd/K4KVV1DeXZjeq/yt0ABR+pGwFPY6SzBhIpzxGKibCDhxwGnz2Ko8G9pWEO8KgCTKJvyiKiF/FqZJAByWhoO7NG25KpIHrog1GeWMEmO1QIVkZlXzwnYKOCktqxJUhR9P3qIbJotNIiO6bKRNJk8R/eLR0tH1ewXelbLF54Nywv+KJaURRoAZdDV9KLGx2kwaGnighOxy5xGxCXTAaXTzeEVj5GG3Fk66MmxmsHOmbUhc3S5A8hW3Y9Q6NCYDMFhgWO+0lt9jEL9aMXv048/Kg5/nN0D8tVlYhFrgf332zbVq9KtJUEZ081dT8D1TFWPm0r4sobhVPEhBq22eb5lHW+jw6EO2sHrPRZLenSV+xmEZzi2UZBuX7MguaAyMEhqA3xCtBLAQT1nGQk6Tl5px4H15PEm0JhvvisLCEZjNrcc7hPnpVLYhCHb9sSJ",
      "encryptedContentSize": 396,
      "coi": "Beta"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Beta\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Beta), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Beta')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: jJmM1SU6RWqYXlt3\n  Hex: 8c998cd5253a456a985e5b77\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: VQmb3aJ0ItLsGdRhX8VIrg==\n  Hex: 55099bdda27422d2ec19d4615fc548ae\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Beta')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Beta');\n  const iv = Buffer.from('jJmM1SU6RWqYXlt3', 'base64');\n  const authTag = Buffer.from('VQmb3aJ0ItLsGdRhX8VIrg==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Beta')  # 32 bytes\n  iv = base64.b64decode('jJmM1SU6RWqYXlt3')\n  auth_tag = base64.b64decode('VQmb3aJ0ItLsGdRhX8VIrg==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084612-0155",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.952Z",
      "displayMarking": "TOP_SECRET//Beta//REL USA, FRA, DEU"
    }
  }
]