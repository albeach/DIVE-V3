[
  {
    "resourceId": "doc-generated-1762442084103-0043",
    "title": "Operational Plan - Maritime Security 43",
    "classification": "RESTRICTED",
    "releasabilityTo": [
      "USA",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Beta"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "CzRwm3Ywgh1Sr507",
      "authTagBase64": "5kCmpXv6lMADL8iJ9wiAsA==",
      "encryptedContentBase64": "E5AbP0hbAcZrkRvQRrHrNO0qIBfU8A1t2G8gDzhusLAnwR4wqdaF/keT9Qr3IxDvAWTV9gAcm/oBsJVWDEr4AcY88jBmQ4AZxsco8zgFkUWK4BMZK5oY3xoNMGzQrz7N0OY5kODc/uiNFtqikWI2wxmWvWz5zt7ZrjS+u1XPhmXBr+D7Nct4+P6kgWaS5BMyMt61Cnh5jOVelrZH0tZV4hFoLkakLHUOfZgXDUNjjIbot1WTd8ed6ct+LZDpfB1hR/h8R+e3IxbYjDV2aERhuXW/NfmTfaZLY1HH8cSAsm3iOtpJn5CIWbChBNVrTSkedXJZJV+v8CVL0qIZ2n0bt2DDSp6bYFhlMscDwiSvOQ3Krpe9Pb4XAi9MgqB+1d3vSrc9J1H1CQFuMgEJ2Zsl7iIhX6dgkWLR3WjPAif0f0ljFUlrPrZb9TlU0Zve4JiBkbeng/hJrX/0C1bKFT9piCC68ghPRxuf68Dgo5TQDdMB+4R5bf9Nh2E3X/3RkAnCxVrlLVGhwCGjTu8FQ17l2hOB/w==",
      "encryptedContentSize": 403,
      "coi": "Beta"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Beta\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Beta), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Beta')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: CzRwm3Ywgh1Sr507\n  Hex: 0b34709b7630821d52af9d3b\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: 5kCmpXv6lMADL8iJ9wiAsA==\n  Hex: e640a6a57bfa94c0032fc889f70880b0\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Beta')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Beta');\n  const iv = Buffer.from('CzRwm3Ywgh1Sr507', 'base64');\n  const authTag = Buffer.from('5kCmpXv6lMADL8iJ9wiAsA==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Beta')  # 32 bytes\n  iv = base64.b64decode('CzRwm3Ywgh1Sr507')\n  auth_tag = base64.b64decode('5kCmpXv6lMADL8iJ9wiAsA==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084103-0043",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.586Z",
      "displayMarking": "RESTRICTED//Beta//REL USA, FRA, DEU"
    }
  },
  {
    "resourceId": "doc-generated-1762442084103-0079",
    "title": "Logistics Plan - Air Superiority 79",
    "classification": "RESTRICTED",
    "releasabilityTo": [
      "USA",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Beta"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "8L5+uPUNOVqA7P31",
      "authTagBase64": "KH8Jzg3MabRoMM0BdJXTsA==",
      "encryptedContentBase64": "rL8GGE+VRUPxGf6CL1kwYleQ/KHT2rU84cE2jKjIauWrGPk0n1FEFwQNSUwELOOhbqUkSqstKjoIoNWg7UIlQXXrqPtMYKHBkNCgpmf2Fw1JWjwvd0ePGQN+GeFBx5isgUjOnkowfgN81PbeapjsZxQCC3FDgFUfefaQePPon///+cFdyd1jq3BMEiJfw1QrXk/wcmWkWnvrrSXY4yBbvSuEbsc6QlIuwDLhK0FGeOwQ5eF95YLn4+ZQ0biO7DimlC2emZ1IoXKUrplQkXaltAUsWVCppOA/XjYRhoj/Kin0IEmASAYTK7Kc8ADNhx10Txodqyhz2l/VdHYeRukix2FbCTHlOopi0lL3OSBcxcphk2yResF6KI7oSJClyqYDho1r3SfZZyy+NSbVi/6DDS2VojYssgaW/e6YitpnTtUn0Cjvlcrwpe1lNRMqgUaeyCXj6CplhM+Sd2YiHo3L2C+eGko0DMQ1qiYhHEJMggoU9wWn5fqTHH7uxpCdE7/EswTgePTqXs76n4UTKjlx",
      "encryptedContentSize": 399,
      "coi": "Beta"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Beta\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Beta), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Beta')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: 8L5+uPUNOVqA7P31\n  Hex: f0be7eb8f50d395a80ecfdf5\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: KH8Jzg3MabRoMM0BdJXTsA==\n  Hex: 287f09ce0dcc69b46830cd017495d3b0\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Beta')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Beta');\n  const iv = Buffer.from('8L5+uPUNOVqA7P31', 'base64');\n  const authTag = Buffer.from('KH8Jzg3MabRoMM0BdJXTsA==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Beta')  # 32 bytes\n  iv = base64.b64decode('8L5+uPUNOVqA7P31')\n  auth_tag = base64.b64decode('KH8Jzg3MabRoMM0BdJXTsA==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084103-0079",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.573Z",
      "displayMarking": "RESTRICTED//Beta//REL USA, FRA, DEU"
    }
  },
  {
    "resourceId": "doc-generated-1762442084104-0080",
    "title": "Logistics Plan - Southern Theater 80",
    "classification": "RESTRICTED",
    "releasabilityTo": [
      "USA",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Beta"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "Q6J9zwclP7WrCg67",
      "authTagBase64": "GaBxjxuoPiAexv7Ip2dpUg==",
      "encryptedContentBase64": "2PiKHuD5E8e6GPDNGIQ7xyoESuzdFCOJSOLrycekg0fNOEw6/31iceGAvZXzvB9/YoGRmZvvZDVCj9dRHUeTYZYwk7y9cvpaPz4SbB6J8V2B4brBwtBSgsjjmHsJy10/PvXcnKl/saX/I4DitRj/bl/B8HWB1TG0vYZYwmDjw+Oezdc7TiuRvHP4uCHi5sAq/cHA56nop/dfXX+ef9QpZxTFHCrG4chajSxEqFe392hpCzKh86mrM8syI5gHBQKpiopl+mT31QqwAzdqyrQbc52UThOVC+ZXd0W8u8qLMtaQkbQWC9PP7lEWsu4lBqx/kbm5WptcubhZZpt14QJVvqSfYF/JOIh7D3ow1e5E/Hji6Cy01dvp2W8aKRFTA7CULEb38mgMPWtqBNDWUs5r83SBhv2qAx2k1XwEi3p7HVq+EiEG+HmA3UM66jVRTlBsZsFcAKi/8MWcszbDVfkZ62dW62VdmKkjwtIkmzrTgNXMAKENym51pV6oPFM25LhWDQd+7nCVeIvVsgXKPjEhew==",
      "encryptedContentSize": 400,
      "coi": "Beta"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Beta\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Beta), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Beta')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: Q6J9zwclP7WrCg67\n  Hex: 43a27dcf07253fb5ab0a0ebb\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: GaBxjxuoPiAexv7Ip2dpUg==\n  Hex: 19a0718f1ba83e201ec6fec8a7676952\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Beta')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Beta');\n  const iv = Buffer.from('Q6J9zwclP7WrCg67', 'base64');\n  const authTag = Buffer.from('GaBxjxuoPiAexv7Ip2dpUg==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Beta')  # 32 bytes\n  iv = base64.b64decode('Q6J9zwclP7WrCg67')\n  auth_tag = base64.b64decode('GaBxjxuoPiAexv7Ip2dpUg==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084104-0080",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.574Z",
      "displayMarking": "RESTRICTED//Beta//REL USA, FRA, DEU"
    }
  },
  {
    "resourceId": "doc-generated-1762442084611-0111",
    "title": "Training Manual - Space Operations 111",
    "classification": "RESTRICTED",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN"
    ],
    "COI": [
      "Alpha"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "Etw9Lg+Jrvgzc7Om",
      "authTagBase64": "3FRqJsRkmR0ETTCpC/NUrg==",
      "encryptedContentBase64": "b4i6zWKuaPzHuDBqJfeAWx5++X6K3yVPSkLfxKoHW7rormRjRL5+uWZ/1wrcUeI70rKSSFgdSnnHT8bG6vqYfIAyHdW53lvKsMnUsHaHAvmNtg9PKEzhlHWpX9XjoatVpMdc9DxWCr2Is6m4LjFA1VcBpnKc+OMC22ozoyolti1xEckkV/sxfncla+2F3HlLVKsj+wA33RgFqHCYQy12d2oaaecHnIXNZLLccmS9vd1ZydywKYfFi8RU3b3BbhxG02MC8sM1jEo6fv+Idx4JLvX619DfiatTKjEuFLCBMhOSqBF91YQbKoCkLgAeX5jtUvkL66r3wQk/TCVdM+TIfkEmT9KgA0w9BXvjNoAIBki5YzG3OxQm+bBUDHkIFoodLudnjnhl60/nLpaDY6plIQJfyo1GUUaXmZdwC5cxOAyyuP1Wj10zXOobFq7GZKQyFWIl/ePAmidRdbOLb63a9M59Tk8dvxyzbM4pSXSJHPd6f/3DbMo2DcXc8EM5WPKItNLNcLJTj+mlhr6DdKmEhSOCCfA=",
      "encryptedContentSize": 404,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: Etw9Lg+Jrvgzc7Om\n  Hex: 12dc3d2e0f89aef83373b3a6\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: 3FRqJsRkmR0ETTCpC/NUrg==\n  Hex: dc546a26c464991d044d30a90bf354ae\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('Etw9Lg+Jrvgzc7Om', 'base64');\n  const authTag = Buffer.from('3FRqJsRkmR0ETTCpC/NUrg==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('Etw9Lg+Jrvgzc7Om')\n  auth_tag = base64.b64decode('3FRqJsRkmR0ETTCpC/NUrg==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084611-0111",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.946Z",
      "displayMarking": "RESTRICTED//Alpha//REL USA, GBR, CAN"
    }
  },
  {
    "resourceId": "doc-generated-1762442084611-0117",
    "title": "Field Report - Balkans 117",
    "classification": "RESTRICTED",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN"
    ],
    "COI": [
      "Alpha"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "g0a2gEaI1RxAgccv",
      "authTagBase64": "pWE3G3Up6ihNKsE0JjpuSQ==",
      "encryptedContentBase64": "QjyJK4g6knlTjOWyfVYsPScqCThtdWkPcwmdUbX8PRJywXa1DbRQS1H+Q7uIrjB+/u9eVKDj2UZt6zAsLEYZXcAyplbJL6f20y/fS8Mvni/Jg2lEX98wZsJLI69COCaH+QxvmtHLTUuClMdgrfgdb1Jg5IYeyuyGw0mWR4gFjaaB7Ul/JeJ3bs1MZP0fzozTp92NmiXwPLlh5t6TmN421RwZG7S4UZrP/zMC/1A07pY/UzU3DLngvqLaDoHnmMjQVu+wACiGYYEYe3tAWYJfx0WjIwOpear/qnXe9mSm86DehzAdwiXSAEDY5/LMnOqD5bpTxHlpX3ofiI1B2SNjRux2nfgeLwPI9eaAM+R643EGlm/Ys4vS1aF2pMFv18Yim9tMv5VTwfZzUSIAENXlyG2of1/CnOT755LmisnvfYO4fmBj2ogHG2/xCf47CubEdwne2D2wVIWTtUzKlH0YsJVNRTu+40b3drqmfO5heMkhYrrybRwE94doU6lGhxgsLyPwUsH3vDc=",
      "encryptedContentSize": 392,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: g0a2gEaI1RxAgccv\n  Hex: 8346b6804688d51c4081c72f\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: pWE3G3Up6ihNKsE0JjpuSQ==\n  Hex: a561371b7529ea284d2ac134263a6e49\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('g0a2gEaI1RxAgccv', 'base64');\n  const authTag = Buffer.from('pWE3G3Up6ihNKsE0JjpuSQ==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('g0a2gEaI1RxAgccv')\n  auth_tag = base64.b64decode('pWE3G3Up6ihNKsE0JjpuSQ==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084611-0117",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.954Z",
      "displayMarking": "RESTRICTED//Alpha//REL USA, GBR, CAN"
    }
  }
]