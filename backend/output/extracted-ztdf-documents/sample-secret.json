[
  {
    "resourceId": "doc-generated-1762442084102-0003",
    "title": "Intelligence Report - Eastern Border 3",
    "classification": "SECRET",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN"
    ],
    "COI": [
      "Alpha"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "WGucMlJCu9H58rZs",
      "authTagBase64": "0of+VgNB9w0bem7nTOlpMw==",
      "encryptedContentBase64": "gtK6311LUiKIdR1G5fNqQE7A+dFAVy6GsRvmcf8vnskzZjcT+TSpJonYo9uSNeoJljAPu82RVS+Z1g9DsCvlZPAdBAwxHVCQTGWmV8WisylTn+fiBp5E5hPgxxd0H3xqaFbxpzOAw+YR8a8QG1Du8rMQ73BM1bUWD+uRFILeD3Ram7zoFa4doDjXLUz8WZ+VpZNNT6jVrE7Dd9MyRR0Ot//r50qBGN3U1cj46mXbgtFGdYTeyPGradZCMlk2CMWyvy7p/vvJDHoPHx5h4pa6iPNEBF7ThroZpPoB4SyFeBniRlFmRtocdO2ClQ4CsPfXDsWUBZOGWobEX+ciYYhzMZMEb/rnHHvGpprTHNMpQGyI+QftGGcs8o6mSwSIQdvRq1BgSqAehQNTq9+3C3JNfDI9fWZ4dYC+9IfV6ArbGWky7Lxdpu/0iyoQfc2IM5MGiHzDsERyAjodoTMePQRe37OyvrSfJ8E8K8EWO3W2+vxVhrHf7YGVsBqVooWZQJkw3KblAB1kSOkK/Lik",
      "encryptedContentSize": 396,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: WGucMlJCu9H58rZs\n  Hex: 586b9c325242bbd1f9f2b66c\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: 0of+VgNB9w0bem7nTOlpMw==\n  Hex: d287fe560341f70d1b7a6ee74ce96933\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('WGucMlJCu9H58rZs', 'base64');\n  const authTag = Buffer.from('0of+VgNB9w0bem7nTOlpMw==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('WGucMlJCu9H58rZs')\n  auth_tag = base64.b64decode('0of+VgNB9w0bem7nTOlpMw==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084102-0003",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.562Z",
      "displayMarking": "SECRET//Alpha//REL USA, GBR, CAN"
    }
  },
  {
    "resourceId": "doc-generated-1762442084104-0088",
    "title": "Defense White Paper - Eastern Border 88",
    "classification": "SECRET",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Alpha",
      "Beta"
    ],
    "coiOperator": "ANY",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "gMO62TVgQQ5fBO6A",
      "authTagBase64": "OjwXDZNlV8apw2ChQjcA6w==",
      "encryptedContentBase64": "mcjDTEq3Smg9u9JHBaVWGLzbA1ZDN0tRARxC4ikX5EFXDntWJCxJppe8mVgyqLJpaxY2k6/zDFw84OwDrm1R+BISFG2rVjH0E+c0LOtabCjy37FsTZhf8gyHvvvRbyBTe4byILRTRpPtYWc7pt2+MtXhwF+Jmns1YI+mTpiLnTztpC7Dh3XAetI+z4p8m74+KC6SISXUe9jiAWGn8DAEiqA0oPsn72qsS85BAdFnorbzevIDhOtbaD9JCWA0cV/IMgwmDxpAv/9918QpXeNhj/mkW97tLt57yxsf02qbtYgvrsDQ6EDHJIqKah8GqdkC2X7khqJMwCb3/CBa6X10h+L4tBIZCcKDRFRV4jrHfwXRc++cDT5BiQC5HWM39aWIznrUVZj/Kvt1FY7I6YihdtFemyHAY6s14z9lM9GMBTK05OBmv5BJWhwSHq4CYL9mLPAh7A+AbBxQ74aBqlJdhBVs4+m4ob7HzvDky7zoTG/o+sUr2I1tEXv9hjMUfePgkDbSKPVx1B8lagVPGvoDHKoBGC8kjtN3tX9IBoPD+DUs8Ocv6w==",
      "encryptedContentSize": 421,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: gMO62TVgQQ5fBO6A\n  Hex: 80c3bad93560410e5f04ee80\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: OjwXDZNlV8apw2ChQjcA6w==\n  Hex: 3a3c170d936557c6a9c360a1423700eb\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('gMO62TVgQQ5fBO6A', 'base64');\n  const authTag = Buffer.from('OjwXDZNlV8apw2ChQjcA6w==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('gMO62TVgQQ5fBO6A')\n  auth_tag = base64.b64decode('OjwXDZNlV8apw2ChQjcA6w==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084104-0088",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.580Z",
      "displayMarking": "SECRET//Alpha-Beta//REL USA, GBR, CAN, FRA, DEU"
    }
  },
  {
    "resourceId": "doc-generated-1762442084611-0114",
    "title": "Command Brief - Baltic Sea 114",
    "classification": "SECRET",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN"
    ],
    "COI": [
      "Alpha"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "yaUavSuVO4//AlIu",
      "authTagBase64": "j2NxQ0W6r/7ZVuFgtVC0pA==",
      "encryptedContentBase64": "GFmDpUAKndHmRx4lU2N2rxRoqzJubEdT1QNBruenKvLm50sRzbn+3YnUYz0pswJc83Yfza5yOAoapYu50n3xHuxOqlugwyFjt5qahL+zSGFGcOz16pMkt1gcqqA2dhdUUPO5vY+uSSGxybTC/J0pRir1rg5NRKGo8XQ6bNrU9VE1eBbxdZKBwBbl1sKP9UCRFPAVm5mdEIr23/945ZWXVIj6JQhLSPIF8ddaKLt41DoY0qhf5rMCOE5NtUGse5meu60DceOVvfftSa4tf6IZAGPr9s3hHVYIs2JJJy3leNzu5TlGZafsbAdGgA2x/t4f7yA6a5uqsjfedYrAcx0RYl+7JuC2BXxP1TaLmemrwHTyohHhflJV4EpRrvgmSNyTGdLQ2iLYPY2ZcS2CBbkJek+/NYmSFitFCQSbAXYKTgxFis1D8HvUlxeFyVjAuwfn+RVY2rn2PAG/3I7lB8pNSqEdKrrtsfy773JtdEiyaaR4rLOnEiHQVMxLGhudR4zsn/GEmA==",
      "encryptedContentSize": 388,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: yaUavSuVO4//AlIu\n  Hex: c9a51abd2b953b8fff02522e\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: j2NxQ0W6r/7ZVuFgtVC0pA==\n  Hex: 8f63714345baaffed956e160b550b4a4\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('yaUavSuVO4//AlIu', 'base64');\n  const authTag = Buffer.from('j2NxQ0W6r/7ZVuFgtVC0pA==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('yaUavSuVO4//AlIu')\n  auth_tag = base64.b64decode('j2NxQ0W6r/7ZVuFgtVC0pA==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084611-0114",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.965Z",
      "displayMarking": "SECRET//Alpha//REL USA, GBR, CAN"
    }
  },
  {
    "resourceId": "doc-generated-1762442084611-0119",
    "title": "Cyber Security - Baltic Sea 119",
    "classification": "SECRET",
    "releasabilityTo": [
      "USA",
      "GBR",
      "CAN",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Alpha",
      "Beta"
    ],
    "coiOperator": "ANY",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "ZdXaQ6oPRu+stHoU",
      "authTagBase64": "H/FGJ4jbZqmwcEV4TVtF5w==",
      "encryptedContentBase64": "dZcmBBnLvcpMQ8X/2uwFFDREqVfctf1oP/MtrRKORCT+gfdAJrl0A2aSXqOuew7SJ7ec1/tRPZIoK1OyTu7doT1TXC39juEoGhwdpv10879IK+x9zF0Dvwrzpdv9/X8x9wHldmFLlpIQEACMFFomcwTui/n1RfXBNRciDyGYVycB7CiFDtoVuUgcgo2S+6WEz76Oqz3zFQvYcuBBbDMivK7rtccojEym8wAMnytGF1iU1bk47fbIlGMXlD2Ty8Q4DjiJ62H8ShOlTfEP7POmm7/KR/604qUwtbK7tr2QWk6fA2vufZhcUM/UjfYdBk0YoLpq45F+4f6XfnzSHBIFZfBwTR+iWad+cbbRTwEFWHfGyxlsCrGj+qUlCyGPsCYQODbAV6t0xxZyrPwOlQd6zjERftlg0cSh4HoELeww2KFjsvO7Eyb9X3DTLkrG42S3OVOJr2es/Ufzb/Ue+z8TloanBRCLu2arlRC+BRuVCp5aLKpnT8Qp1gH1+vFOd/JrBfi4dha/LZia0NX3AxdY7ZbieY7Fp2dvpdZncaE=",
      "encryptedContentSize": 413,
      "coi": "Alpha"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Alpha\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Alpha), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Alpha')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: ZdXaQ6oPRu+stHoU\n  Hex: 65d5da43aa0f46efacb47a14\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: H/FGJ4jbZqmwcEV4TVtF5w==\n  Hex: 1ff1462788db66a9b07045784d5b45e7\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Alpha')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Alpha');\n  const iv = Buffer.from('ZdXaQ6oPRu+stHoU', 'base64');\n  const authTag = Buffer.from('H/FGJ4jbZqmwcEV4TVtF5w==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Alpha')  # 32 bytes\n  iv = base64.b64decode('ZdXaQ6oPRu+stHoU')\n  auth_tag = base64.b64decode('H/FGJ4jbZqmwcEV4TVtF5w==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084611-0119",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.954Z",
      "displayMarking": "SECRET//Alpha-Beta//REL USA, GBR, CAN, FRA, DEU"
    }
  },
  {
    "resourceId": "doc-generated-1762442084612-0177",
    "title": "Training Manual - Central Europe 177",
    "classification": "SECRET",
    "releasabilityTo": [
      "USA",
      "FRA",
      "DEU"
    ],
    "COI": [
      "Beta"
    ],
    "coiOperator": "ALL",
    "encryptionDetails": {
      "algorithm": "AES-256-GCM",
      "keyDerivation": "COI-based community key",
      "ivBase64": "aJB0R0h2M6Cfi/Ap",
      "authTagBase64": "g27iNVr0tsZ/A0zwzwjJkA==",
      "encryptedContentBase64": "hCnQ3JLC2Xa8O3RVOnxGqLXiMGJGW+8EYrUh2TSifNYVirSCXFIjaQNZ+IJis2oaFN5ymhlDmQwLDKUWUy7JrMShpIcOiIiw8doKYCg45yIO8jugY+x09YVIXkSiyJiiqhJ+3UITOZPUbGMt1rpn4VeVgG9Svw99e3axZtsXBG+HX8bow4+mOt+s8em1KENwmPRM/shtxqxbLRcqz6UmeBC/O2mrVmg7Y3Ho3QuYXP+co+AzqlpomydOpc/FzMe1dZei3uLS+du2jx63AMVKl/V8YhNdc3GOgOfjv/iBSE5fcyxldzWO4kgzXgB15xryrOEr0oC886begjWqaHrwdMbvU62MZfolYQ5Q8bEQVpmAfgOOkBz5uk4JHD1KP/y1uCseV5u8GD0eAyiiU94eWq9NBUzw1lMa5xiY+810fijk6ZUBYNy5WJtF7IZgj7wh/lz66oec0xlbquV9hhXs7d/5+wT8uP1KFJtOTjTdDTSRJmZS/pbagsH8vvpqVrp+lFHwF00ehnE=",
      "encryptedContentSize": 392,
      "coi": "Beta"
    },
    "decryptionInstructions": "\nDECRYPTION INSTRUCTIONS\n=======================\n\nAlgorithm: AES-256-GCM\nKey Type: COI-based Community Key\n\nStep 1: Get the COI Community Key\n----------------------------------\nCOI: Beta\n\nThe DEK (Data Encryption Key) is derived from the COI community key.\nIn the DIVE V3 system, COI keys are stored in the COI Key Registry.\n\nFor this COI (Beta), retrieve the key using:\n- Service: coi-key-registry.ts\n- Function: getCOIKey('Beta')\n- Key Size: 256 bits (32 bytes)\n\nStep 2: Extract Encryption Parameters\n--------------------------------------\nIV (Initialization Vector):\n  Base64: aJB0R0h2M6Cfi/Ap\n  Hex: 68907447487633a09f8bf029\n  Size: 12 bytes (96 bits)\n\nAuth Tag (GCM Authentication Tag):\n  Base64: g27iNVr0tsZ/A0zwzwjJkA==\n  Hex: 836ee2355af4b6c67f034cf0cf08c990\n  Size: 16 bytes (128 bits)\n\nStep 3: Decrypt with AES-256-GCM\n---------------------------------\nPseudocode:\n  dek = getCOIKey('Beta')\n  iv = base64Decode(IV)\n  authTag = base64Decode(AuthTag)\n  encryptedData = base64Decode(EncryptedContent)\n  \n  decipher = AES_256_GCM_Decrypt(dek, iv)\n  decipher.setAuthTag(authTag)\n  plaintext = decipher.update(encryptedData) + decipher.final()\n\nNode.js Code:\n  const crypto = require('crypto');\n  const { getCOIKey } = require('./services/coi-key-registry');\n  \n  const dek = getCOIKey('Beta');\n  const iv = Buffer.from('aJB0R0h2M6Cfi/Ap', 'base64');\n  const authTag = Buffer.from('g27iNVr0tsZ/A0zwzwjJkA==', 'base64');\n  const encryptedData = '...'; // From encryptedContentBase64\n  \n  const decipher = crypto.createDecipheriv('aes-256-gcm', dek, iv);\n  decipher.setAuthTag(authTag);\n  let plaintext = decipher.update(encryptedData, 'base64', 'utf8');\n  plaintext += decipher.final('utf8');\n  console.log(plaintext);\n\nPython Code:\n  from cryptography.hazmat.primitives.ciphers.aead import AESGCM\n  import base64\n  \n  dek = get_coi_key('Beta')  # 32 bytes\n  iv = base64.b64decode('aJB0R0h2M6Cfi/Ap')\n  auth_tag = base64.b64decode('g27iNVr0tsZ/A0zwzwjJkA==')\n  encrypted_data = base64.b64decode(encrypted_content_base64)\n  \n  aesgcm = AESGCM(dek)\n  plaintext = aesgcm.decrypt(iv, encrypted_data + auth_tag, None)\n  print(plaintext.decode('utf-8'))\n\nStep 4: Verify Integrity\n-------------------------\nAfter decryption, verify the authentication tag matches.\nIf auth tag verification fails, the content has been tampered with.\n\nSecurity Notes:\n- Never expose the DEK in logs\n- DEK should only exist in memory during decryption\n- Verify payload hash matches ZTDF manifest\n- Check policy binding before releasing DEK\n",
    "ztdfMetadata": {
      "version": "1.0",
      "objectId": "doc-generated-1762442084612-0177",
      "owner": "550e8400-e29b-41d4-a716-446655440001",
      "createdAt": "2025-11-06T15:14:44.959Z",
      "displayMarking": "SECRET//Beta//REL USA, FRA, DEU"
    }
  }
]