# =============================================================================
# DIVE V3 - Kustomize Base Configuration
# =============================================================================
# Base Kubernetes manifests for DIVE V3
# Use overlays for environment-specific configurations
# =============================================================================

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: dive-v3

resources:
  # Namespace
  - namespace.yaml
  
  # Frontend
  - frontend/serviceaccount.yaml
  - frontend/deployment.yaml
  - frontend/service.yaml
  - frontend/configmap.yaml
  
  # Backend
  - backend/serviceaccount.yaml
  - backend/deployment.yaml
  - backend/service.yaml
  - backend/configmap.yaml
  
  # Keycloak
  - keycloak/serviceaccount.yaml
  - keycloak/deployment.yaml
  - keycloak/service.yaml
  
  # OPA
  - opa/deployment.yaml
  - opa/service.yaml
  
  # PostgreSQL
  - postgres/deployment.yaml
  - postgres/service.yaml
  - postgres/pvc.yaml
  
  # MongoDB
  - mongo/deployment.yaml
  - mongo/service.yaml
  - mongo/pvc.yaml
  
  # Redis
  - redis/deployment.yaml
  - redis/service.yaml
  - redis/pvc.yaml
  
  # Database Migration
  - db-migration/job.yaml
  
  # Ingress
  - ingress.yaml
  - managed-certificate.yaml

commonLabels:
  app.kubernetes.io/part-of: dive-v3
  app.kubernetes.io/managed-by: kustomize

