{
  "$schema": "./federation-registry.schema.json",
  "version": "3.1.0",
  "metadata": {
    "lastUpdated": "2025-11-30T12:00:00Z",
    "maintainer": "DIVE V3 Ops Team",
    "compliance": [
      "ACP-240",
      "NIST 800-63",
      "STANAG 4774",
      "STANAG 4778"
    ],
    "description": "DIVE V3 Federation Registry - Single Source of Truth for ALL instance configurations including service definitions, ports, routing, and healthcheck configurations"
  },
  "serviceDefaults": {
    "_comment": "Default internal ports for all services - containers always listen on these ports",
    "frontend": {
      "internalPort": 3000,
      "protocol": "https",
      "healthcheck": "/",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "30s"
    },
    "backend": {
      "internalPort": 4000,
      "protocol": "https",
      "healthcheck": "/health",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "30s"
    },
    "keycloak": {
      "internalPort": 8443,
      "internalPortHttp": 8080,
      "protocol": "https",
      "healthcheck": "/health/ready",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "60s"
    },
    "kas": {
      "internalPort": 8080,
      "protocol": "http",
      "healthcheck": "/health",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "30s"
    },
    "postgres": {
      "internalPort": 5432,
      "protocol": "tcp",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "30s"
    },
    "mongodb": {
      "internalPort": 27017,
      "protocol": "tcp",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "30s"
    },
    "redis": {
      "internalPort": 6379,
      "protocol": "tcp",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "10s"
    },
    "opa": {
      "internalPort": 8181,
      "protocol": "http",
      "healthcheck": "/health",
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "10s"
    },
    "cloudflared": {
      "restartPolicy": "unless-stopped",
      "stopGracePeriod": "10s"
    }
  },
  "healthcheckTemplates": {
    "_comment": "Standardized healthcheck configurations for Docker Compose (P0 hardening - Nov 30, 2025)",
    "postgres": {
      "test": [
        "CMD-SHELL",
        "pg_isready -U ${POSTGRES_USER:-postgres}"
      ],
      "interval": "10s",
      "timeout": "5s",
      "retries": 5,
      "startPeriod": "10s"
    },
    "mongodb": {
      "test": [
        "CMD",
        "mongosh",
        "--eval",
        "db.adminCommand('ping')"
      ],
      "interval": "10s",
      "timeout": "5s",
      "retries": 5,
      "startPeriod": "10s"
    },
    "redis": {
      "test": [
        "CMD",
        "redis-cli",
        "ping"
      ],
      "interval": "10s",
      "timeout": "5s",
      "retries": 5,
      "startPeriod": "5s"
    },
    "keycloak": {
      "test": [
        "CMD-SHELL",
        "curl -ksf https://localhost:9000/health/ready || exit 1"
      ],
      "interval": "30s",
      "timeout": "10s",
      "retries": 5,
      "startPeriod": "90s",
      "_note": "Keycloak 26+ health on management port 9000 (HTTPS)"
    },
    "opa": {
      "test": [
        "CMD",
        "/opa",
        "version"
      ],
      "interval": "10s",
      "timeout": "5s",
      "retries": 5,
      "startPeriod": "10s",
      "_note": "OPA distroless image only has /opa binary, no wget/curl"
    },
    "backend": {
      "test": [
        "CMD",
        "curl",
        "-kfs",
        "https://localhost:4000/health"
      ],
      "interval": "15s",
      "timeout": "10s",
      "retries": 5,
      "startPeriod": "30s"
    },
    "frontend": {
      "test": [
        "CMD",
        "curl",
        "-kfsI",
        "--max-time",
        "10",
        "https://localhost:3000/"
      ],
      "interval": "30s",
      "timeout": "15s",
      "retries": 10,
      "startPeriod": "120s",
      "_note": "P0 Fix (Dec 2025): max-time increased from 5s to 10s to prevent false unhealthy due to slow SSR"
    },
    "kas": {
      "test": [
        "CMD",
        "curl",
        "-kfs",
        "https://localhost:8080/health"
      ],
      "interval": "15s",
      "timeout": "10s",
      "retries": 5,
      "startPeriod": "30s"
    },
    "cloudflared": {
      "test": [
        "CMD",
        "cloudflared",
        "version"
      ],
      "interval": "30s",
      "timeout": "10s",
      "retries": 5,
      "startPeriod": "30s"
    }
  },
  "defaults": {
    "realm": "dive-v3-broker",
    "clientId": "dive-v3-broker",
    "tokenLifetime": "15m",
    "sessionLifetime": "10h",
    "clearanceLevels": [
      "UNCLASSIFIED",
      "CONFIDENTIAL",
      "SECRET",
      "TOP_SECRET"
    ],
    "passwordPolicy": {
      "minLength": 16,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireDigits": true,
      "requireSpecialChars": true,
      "passwordHistory": 5
    }
  },
  "instances": {
    "usa": {
      "code": "USA",
      "name": "United States",
      "locale": "en-US",
      "type": "local",
      "primary": true,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.yml",
        "projectName": "usa"
      },
      "services": {
        "_comment": "USA is the primary instance - services use base names without suffix",
        "frontend": {
          "name": "frontend",
          "containerName": "dive-v3-frontend",
          "internalPort": 3000,
          "externalPort": 3000,
          "protocol": "https",
          "hostname": "usa-app.dive25.com"
        },
        "backend": {
          "name": "backend",
          "containerName": "dive-v3-backend",
          "internalPort": 4000,
          "externalPort": 4000,
          "protocol": "https",
          "hostname": "usa-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak",
          "containerName": "dive-v3-keycloak",
          "internalPort": 8443,
          "externalPort": 8443,
          "protocol": "https",
          "hostname": "usa-idp.dive25.com"
        },
        "kas": {
          "name": "kas",
          "containerName": "dive-v3-kas",
          "internalPort": 8080,
          "externalPort": 8090,
          "protocol": "http",
          "hostname": "usa-kas.dive25.com"
        },
        "postgres": {
          "name": "postgres",
          "containerName": "dive-v3-postgres",
          "internalPort": 5432,
          "externalPort": 5433
        },
        "mongodb": {
          "name": "mongo",
          "containerName": "dive-v3-mongo",
          "internalPort": 27017,
          "externalPort": 27017
        },
        "redis": {
          "name": "redis",
          "containerName": "dive-v3-redis",
          "internalPort": 6379,
          "externalPort": 6379
        },
        "opa": {
          "name": "opa",
          "containerName": "dive-v3-opa",
          "internalPort": 8181,
          "externalPort": 8181
        }
      },
      "cloudflare": {
        "tunnelId": "f8e6c558-847b-4952-b8b2-27f98a85e36c",
        "tunnelName": "dive-v3-tunnel",
        "credentialsFile": "cloudflared/tunnel-credentials.json",
        "configFile": "cloudflared/config.yml",
        "metricsPort": 9126
      },
      "secrets": {
        "gcpProjectId": "dive25",
        "keycloakAdmin": "dive-v3-keycloak-usa",
        "keycloakClientSecret": "dive-v3-keycloak-client-secret-usa",
        "postgres": "dive-v3-postgres-usa",
        "mongodb": "dive-v3-mongodb-usa",
        "redis": "dive-v3-redis-usa",
        "authSecret": "dive-v3-auth-secret-usa",
        "jwtSecret": "dive-v3-jwt-secret-usa",
        "nextauthSecret": "dive-v3-nextauth-secret-usa"
      },
      "keycloak": {
        "adminUsername": "admin",
        "database": {
          "name": "keycloak_db",
          "user": "postgres"
        },
        "theme": "dive-v3-usa"
      },
      "mongodb": {
        "database": "dive-v3",
        "user": "admin"
      },
      "testUsers": {
        "create": true,
        "clearances": [
          1,
          2,
          3,
          4
        ],
        "usernameTemplate": "testuser-{code}-{level}",
        "emailDomain": "dive-demo.example"
      }
    },
    "fra": {
      "code": "FRA",
      "name": "France",
      "locale": "fr-FR",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.fra.yml",
        "projectName": "fra"
      },
      "services": {
        "_comment": "FRA uses fra- prefix on all service names",
        "frontend": {
          "name": "frontend-fra",
          "containerName": "dive-spoke-fra-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "fra-app.dive25.com"
        },
        "backend": {
          "name": "backend-fra",
          "containerName": "dive-spoke-fra-backend",
          "internalPort": 4000,
          "externalPort": 4457,
          "protocol": "https",
          "hostname": "fra-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-fra",
          "containerName": "dive-spoke-fra-keycloak",
          "internalPort": 8443,
          "externalPort": 8453,
          "protocol": "https",
          "hostname": "fra-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-fra",
          "containerName": "dive-spoke-fra-mongodb",
          "internalPort": 27017,
          "externalPort": 27020,
          "protocol": "mongodb"
        }
      }
    },
    "gbr": {
      "code": "GBR",
      "name": "United Kingdom",
      "locale": "en-GB",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.gbr.yml",
        "projectName": "gbr"
      },
      "services": {
        "_comment": "GBR uses gbr- prefix on all service names",
        "frontend": {
          "name": "frontend-gbr",
          "containerName": "dive-spoke-gbr-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "gbr-app.dive25.com"
        },
        "backend": {
          "name": "backend-gbr",
          "containerName": "dive-spoke-gbr-backend",
          "internalPort": 4000,
          "externalPort": 4031,
          "protocol": "https",
          "hostname": "gbr-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-gbr",
          "containerName": "dive-spoke-gbr-keycloak",
          "internalPort": 8443,
          "externalPort": 8474,
          "protocol": "https",
          "hostname": "gbr-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-gbr",
          "containerName": "dive-spoke-gbr-mongodb",
          "internalPort": 27017,
          "externalPort": 27048,
          "protocol": "mongodb"
        }
      }
    },
    "deu": {
      "code": "DEU",
      "name": "Germany",
      "locale": "de-DE",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.deu.yml",
        "projectName": "deu"
      },
      "services": {
        "_comment": "DEU uses deu- prefix on all service names",
        "frontend": {
          "name": "frontend-deu",
          "containerName": "dive-spoke-deu-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "deu-app.dive25.com"
        },
        "backend": {
          "name": "backend-deu",
          "containerName": "dive-spoke-deu-backend",
          "internalPort": 4000,
          "externalPort": 4457,
          "protocol": "https",
          "hostname": "deu-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-deu",
          "containerName": "dive-spoke-deu-keycloak",
          "internalPort": 8443,
          "externalPort": 8454,
          "protocol": "https",
          "hostname": "deu-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-deu",
          "containerName": "dive-spoke-deu-mongodb",
          "internalPort": 27017,
          "externalPort": 27020,
          "protocol": "mongodb"
        }
      }
    },
    "est": {
      "code": "EST",
      "name": "Estonia",
      "locale": "et-EE",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.est.yml",
        "projectName": "est"
      },
      "services": {
        "_comment": "EST uses est- prefix on all service names",
        "frontend": {
          "name": "frontend-est",
          "containerName": "dive-spoke-est-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "est-app.dive25.com"
        },
        "backend": {
          "name": "backend-est",
          "containerName": "dive-spoke-est-backend",
          "internalPort": 4000,
          "externalPort": 4008,
          "protocol": "https",
          "hostname": "est-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-est",
          "containerName": "dive-spoke-est-keycloak",
          "internalPort": 8443,
          "externalPort": 8451,
          "protocol": "https",
          "hostname": "est-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-est",
          "containerName": "dive-spoke-est-mongodb",
          "internalPort": 27017,
          "externalPort": 27025,
          "protocol": "mongodb"
        }
      }
    },
    "esp": {
      "code": "ESP",
      "name": "Spain",
      "locale": "es-ES",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.esp.yml",
        "projectName": "esp"
      },
      "services": {
        "_comment": "ESP uses esp- prefix on all service names",
        "frontend": {
          "name": "frontend-esp",
          "containerName": "dive-spoke-esp-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "esp-app.dive25.com"
        },
        "backend": {
          "name": "backend-esp",
          "containerName": "dive-spoke-esp-backend",
          "internalPort": 4000,
          "externalPort": 4008,
          "protocol": "https",
          "hostname": "esp-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-esp",
          "containerName": "dive-spoke-esp-keycloak",
          "internalPort": 8443,
          "externalPort": 8451,
          "protocol": "https",
          "hostname": "esp-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-esp",
          "containerName": "dive-spoke-esp-mongodb",
          "internalPort": 27017,
          "externalPort": 27025,
          "protocol": "mongodb"
        }
      }
    },
    "ita": {
      "code": "ITA",
      "name": "Italy",
      "locale": "it-IT",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.ita.yml",
        "projectName": "ita"
      },
      "services": {
        "_comment": "ITA uses ita- prefix on all service names",
        "frontend": {
          "name": "frontend-ita",
          "containerName": "dive-spoke-ita-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "ita-app.dive25.com"
        },
        "backend": {
          "name": "backend-ita",
          "containerName": "dive-spoke-ita-backend",
          "internalPort": 4000,
          "externalPort": 4015,
          "protocol": "https",
          "hostname": "ita-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-ita",
          "containerName": "dive-spoke-ita-keycloak",
          "internalPort": 8443,
          "externalPort": 8458,
          "protocol": "https",
          "hostname": "ita-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-ita",
          "containerName": "dive-spoke-ita-mongodb",
          "internalPort": 27017,
          "externalPort": 27032,
          "protocol": "mongodb"
        }
      }
    },
    "lva": {
      "code": "LVA",
      "name": "Latvia",
      "locale": "lv-LV",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.lva.yml",
        "projectName": "lva"
      },
      "services": {
        "_comment": "LVA uses lva- prefix on all service names",
        "frontend": {
          "name": "frontend-lva",
          "containerName": "dive-spoke-lva-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "lva-app.dive25.com"
        },
        "backend": {
          "name": "backend-lva",
          "containerName": "dive-spoke-lva-backend",
          "internalPort": 4000,
          "externalPort": 4016,
          "protocol": "https",
          "hostname": "lva-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-lva",
          "containerName": "dive-spoke-lva-keycloak",
          "internalPort": 8443,
          "externalPort": 8459,
          "protocol": "https",
          "hostname": "lva-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-lva",
          "containerName": "dive-spoke-lva-mongodb",
          "internalPort": 27017,
          "externalPort": 27033,
          "protocol": "mongodb"
        }
      },
      "mongodb": {
        "database": "dive_resources_lva",
        "user": "admin"
      }
    },
    "lux": {
      "code": "LUX",
      "name": "Luxembourg",
      "locale": "lb-LU",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.lux.yml",
        "projectName": "lux"
      },
      "services": {
        "_comment": "LUX uses lux- prefix on all service names",
        "frontend": {
          "name": "frontend-lux",
          "containerName": "dive-spoke-lux-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "lux-app.dive25.com"
        },
        "backend": {
          "name": "backend-lux",
          "containerName": "dive-spoke-lux-backend",
          "internalPort": 4000,
          "externalPort": 4018,
          "protocol": "https",
          "hostname": "lux-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-lux",
          "containerName": "dive-spoke-lux-keycloak",
          "internalPort": 8443,
          "externalPort": 8461,
          "protocol": "https",
          "hostname": "lux-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-lux",
          "containerName": "dive-spoke-lux-mongodb",
          "internalPort": 27017,
          "externalPort": 27035,
          "protocol": "mongodb"
        }
      }
    },
    "cze": {
      "code": "CZE",
      "name": "Czechia",
      "locale": "cs-CZ",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.cze.yml",
        "projectName": "cze"
      },
      "services": {
        "_comment": "CZE uses cze- prefix on all service names",
        "frontend": {
          "name": "frontend-cze",
          "containerName": "dive-spoke-cze-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "cze-app.dive25.com"
        },
        "backend": {
          "name": "backend-cze",
          "containerName": "dive-spoke-cze-backend",
          "internalPort": 4000,
          "externalPort": 4006,
          "protocol": "https",
          "hostname": "cze-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-cze",
          "containerName": "dive-spoke-cze-keycloak",
          "internalPort": 8443,
          "externalPort": 8449,
          "protocol": "https",
          "hostname": "cze-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-cze",
          "containerName": "dive-spoke-cze-mongodb",
          "internalPort": 27017,
          "externalPort": 27023,
          "protocol": "mongodb"
        }
      }
    },
    "mne": {
      "code": "MNE",
      "name": "Montenegro",
      "locale": "sr-ME",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.mne.yml",
        "projectName": "mne"
      },
      "services": {
        "_comment": "MNE uses mne- prefix on all service names",
        "frontend": {
          "name": "frontend-mne",
          "containerName": "dive-spoke-mne-frontend",
          "internalPort": 3000,
          "externalPort": 3459,
          "protocol": "https",
          "hostname": "mne-app.dive25.com"
        },
        "backend": {
          "name": "backend-mne",
          "containerName": "dive-spoke-mne-backend",
          "internalPort": 4000,
          "externalPort": 4018,
          "protocol": "https",
          "hostname": "mne-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-mne",
          "containerName": "dive-spoke-mne-keycloak",
          "internalPort": 8443,
          "externalPort": 8461,
          "protocol": "https",
          "hostname": "mne-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-mne",
          "containerName": "dive-spoke-mne-mongodb",
          "internalPort": 27017,
          "externalPort": 27035,
          "protocol": "mongodb"
        }
      },
      "mongodb": {
        "database": "dive_resources_mne",
        "user": "admin"
      }
    },
    "nld": {
      "code": "NLD",
      "name": "Netherlands",
      "locale": "nl-NL",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.nld.yml",
        "projectName": "nld"
      },
      "services": {
        "_comment": "NLD uses nld- prefix on all service names",
        "frontend": {
          "name": "frontend-nld",
          "containerName": "dive-spoke-nld-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "nld-app.dive25.com"
        },
        "backend": {
          "name": "backend-nld",
          "containerName": "dive-spoke-nld-backend",
          "internalPort": 4000,
          "externalPort": 4020,
          "protocol": "https",
          "hostname": "nld-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-nld",
          "containerName": "dive-spoke-nld-keycloak",
          "internalPort": 8443,
          "externalPort": 8463,
          "protocol": "https",
          "hostname": "nld-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-nld",
          "containerName": "dive-spoke-nld-mongodb",
          "internalPort": 27017,
          "externalPort": 27037,
          "protocol": "mongodb"
        }
      }
    },
    "hun": {
      "code": "HUN",
      "name": "Hungary",
      "locale": "hu-HU",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.hun.yml",
        "projectName": "hun"
      },
      "services": {
        "frontend": {
          "name": "frontend-hun",
          "containerName": "dive-spoke-hun-frontend",
          "internalPort": 3000,
          "externalPort": 3013,
          "protocol": "https",
          "hostname": "hun-app.dive25.com"
        },
        "backend": {
          "name": "backend-hun",
          "containerName": "dive-spoke-hun-backend",
          "internalPort": 4000,
          "externalPort": 4013,
          "protocol": "https",
          "hostname": "hun-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-hun",
          "containerName": "dive-spoke-hun-keycloak",
          "internalPort": 8443,
          "externalPort": 8456,
          "protocol": "https",
          "hostname": "hun-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-hun",
          "containerName": "dive-spoke-hun-mongodb",
          "internalPort": 27017,
          "externalPort": 27030,
          "protocol": "mongodb"
        }
      },
      "mongodb": {
        "database": "dive-v3-hun",
        "user": "admin"
      }
    },
    "bgr": {
      "code": "BGR",
      "name": "Bulgaria",
      "locale": "bg-BG",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.bgr.yml",
        "projectName": "bgr"
      },
      "services": {
        "_comment": "BGR uses bgr- prefix on all service names",
        "frontend": {
          "name": "frontend-bgr",
          "containerName": "dive-spoke-bgr-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "bgr-app.dive25.com"
        },
        "backend": {
          "name": "backend-bgr",
          "containerName": "dive-spoke-bgr-backend",
          "internalPort": 4000,
          "externalPort": 4003,
          "protocol": "https",
          "hostname": "bgr-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-bgr",
          "containerName": "dive-spoke-bgr-keycloak",
          "internalPort": 8443,
          "externalPort": 8446,
          "protocol": "https",
          "hostname": "bgr-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-bgr",
          "containerName": "dive-spoke-bgr-mongodb",
          "internalPort": 27017,
          "externalPort": 27020,
          "protocol": "mongodb"
        }
      }
    },
    "pol": {
      "code": "POL",
      "name": "Poland",
      "locale": "pl-PL",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.pol.yml",
        "projectName": "pol"
      },
      "services": {
        "_comment": "POL uses pol- prefix on all service names",
        "frontend": {
          "name": "frontend-pol",
          "containerName": "dive-spoke-pol-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "pol-app.dive25.com"
        },
        "backend": {
          "name": "backend-pol",
          "containerName": "dive-spoke-pol-backend",
          "internalPort": 4000,
          "externalPort": 4457,
          "protocol": "https",
          "hostname": "pol-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-pol",
          "containerName": "dive-spoke-pol-keycloak",
          "internalPort": 8443,
          "externalPort": 8466,
          "protocol": "https",
          "hostname": "pol-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-pol",
          "containerName": "dive-spoke-pol-mongodb",
          "internalPort": 27017,
          "externalPort": 27020,
          "protocol": "mongodb"
        }
      }
    },
    "svk": {
      "code": "SVK",
      "name": "Slovakia",
      "locale": "sk-SK",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.svk.yml",
        "projectName": "svk"
      },
      "services": {
        "_comment": "SVK uses svk- prefix on all service names",
        "frontend": {
          "name": "frontend-svk",
          "containerName": "dive-spoke-svk-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "svk-app.dive25.com"
        },
        "backend": {
          "name": "backend-svk",
          "containerName": "dive-spoke-svk-backend",
          "internalPort": 4000,
          "externalPort": 4026,
          "protocol": "https",
          "hostname": "svk-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-svk",
          "containerName": "dive-spoke-svk-keycloak",
          "internalPort": 8443,
          "externalPort": 8469,
          "protocol": "https",
          "hostname": "svk-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-svk",
          "containerName": "dive-spoke-svk-mongodb",
          "internalPort": 27017,
          "externalPort": 27043,
          "protocol": "mongodb"
        }
      }
    },
    "nor": {
      "code": "NOR",
      "name": "Norway",
      "locale": "no-NO",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.nor.yml",
        "projectName": "nor"
      },
      "services": {
        "_comment": "NOR uses nor- prefix on all service names",
        "frontend": {
          "name": "frontend-nor",
          "containerName": "dive-spoke-nor-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "nor-app.dive25.com"
        },
        "backend": {
          "name": "backend-nor",
          "containerName": "dive-spoke-nor-backend",
          "internalPort": 4000,
          "externalPort": 4022,
          "protocol": "https",
          "hostname": "nor-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-nor",
          "containerName": "dive-spoke-nor-keycloak",
          "internalPort": 8443,
          "externalPort": 8465,
          "protocol": "https",
          "hostname": "nor-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-nor",
          "containerName": "dive-spoke-nor-mongodb",
          "internalPort": 27017,
          "externalPort": 27039,
          "protocol": "mongodb"
        }
      }
    },
    "bel": {
      "code": "BEL",
      "name": "Belgium",
      "locale": "nl-BE",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.bel.yml",
        "projectName": "bel"
      },
      "services": {
        "_comment": "BEL uses bel- prefix on all service names",
        "frontend": {
          "name": "frontend-bel",
          "containerName": "dive-spoke-bel-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "bel-app.dive25.com"
        },
        "backend": {
          "name": "backend-bel",
          "containerName": "dive-spoke-bel-backend",
          "internalPort": 4000,
          "externalPort": 4002,
          "protocol": "https",
          "hostname": "bel-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-bel",
          "containerName": "dive-spoke-bel-keycloak",
          "internalPort": 8443,
          "externalPort": 8445,
          "protocol": "https",
          "hostname": "bel-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-bel",
          "containerName": "dive-spoke-bel-mongodb",
          "internalPort": 27017,
          "externalPort": 27019,
          "protocol": "mongodb"
        }
      }
    },
    "nzl": {
      "code": "NZL",
      "name": "New Zealand",
      "locale": "en-NZ",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.nzl.yml",
        "projectName": "nzl"
      },
      "services": {
        "_comment": "NZL uses nzl- prefix on all service names",
        "frontend": {
          "name": "frontend-nzl",
          "containerName": "dive-spoke-nzl-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "nzl-app.dive25.com"
        },
        "backend": {
          "name": "backend-nzl",
          "containerName": "dive-spoke-nzl-backend",
          "internalPort": 4000,
          "externalPort": 4033,
          "protocol": "https",
          "hostname": "nzl-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-nzl",
          "containerName": "dive-spoke-nzl-keycloak",
          "internalPort": 8443,
          "externalPort": 8476,
          "protocol": "https",
          "hostname": "nzl-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-nzl",
          "containerName": "dive-spoke-nzl-mongodb",
          "internalPort": 27017,
          "externalPort": 27050,
          "protocol": "mongodb"
        }
      }
    },
    "hrv": {
      "code": "HRV",
      "name": "Croatia",
      "locale": "hr-HR",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.hrv.yml",
        "projectName": "hrv"
      },
      "services": {
        "_comment": "HRV uses hrv- prefix on all service names",
        "frontend": {
          "name": "frontend-hrv",
          "containerName": "dive-spoke-hrv-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "hrv-app.dive25.com"
        },
        "backend": {
          "name": "backend-hrv",
          "containerName": "dive-spoke-hrv-backend",
          "internalPort": 4000,
          "externalPort": 4005,
          "protocol": "https",
          "hostname": "hrv-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-hrv",
          "containerName": "dive-spoke-hrv-keycloak",
          "internalPort": 8443,
          "externalPort": 8448,
          "protocol": "https",
          "hostname": "hrv-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-hrv",
          "containerName": "dive-spoke-hrv-mongodb",
          "internalPort": 27017,
          "externalPort": 27022,
          "protocol": "mongodb"
        }
      }
    },
    "alb": {
      "code": "ALB",
      "name": "Albania",
      "locale": "sq-AL",
      "type": "local",
      "primary": false,
      "enabled": true,
      "deployment": {
        "provider": "docker",
        "host": "localhost",
        "domain": "dive25.com",
        "composeFile": "docker-compose.alb.yml",
        "projectName": "alb"
      },
      "services": {
        "_comment": "ALB uses alb- prefix on all service names",
        "frontend": {
          "name": "frontend-alb",
          "containerName": "dive-spoke-alb-frontend",
          "internalPort": 3000,
          "externalPort": 3457,
          "protocol": "https",
          "hostname": "alb-app.dive25.com"
        },
        "backend": {
          "name": "backend-alb",
          "containerName": "dive-spoke-alb-backend",
          "internalPort": 4000,
          "externalPort": 4457,
          "protocol": "https",
          "hostname": "alb-api.dive25.com"
        },
        "keycloak": {
          "name": "keycloak-alb",
          "containerName": "dive-spoke-alb-keycloak",
          "internalPort": 8443,
          "externalPort": 8444,
          "protocol": "https",
          "hostname": "alb-idp.dive25.com"
        },
        "mongodb": {
          "name": "mongodb-alb",
          "containerName": "dive-spoke-alb-mongodb",
          "internalPort": 27017,
          "externalPort": 27020,
          "protocol": "mongodb"
        }
      }
    }
  },
  "federation": {
    "model": "hub-spoke",
    "matrix": {
      "usa": [
        "alb",
        "bel",
        "bgr",
        "cze",
        "deu",
        "esp",
        "est",
        "fra",
        "gbr",
        "hrv",
        "hun",
        "ita",
        "lux",
        "lva",
        "mne",
        "nld",
        "nor",
        "nzl",
        "pol",
        "svk"
      ],
      "cze": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "fra": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "gbr": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "deu": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "hun": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "est": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "esp": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "ita": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "lva": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "lux": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "mne": [
        "usa",
        "deu",
        "fra",
        "gbr"
      ],
      "nld": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "bgr": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "pol": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "svk": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "nor": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "bel": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "nzl": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "hrv": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ],
      "alb": [
        "deu",
        "fra",
        "gbr",
        "usa"
      ]
    },
    "defaultEnabled": true,
    "trustModel": "bilateral",
    "attributeMapping": {
      "clearance": {
        "required": true,
        "claim": "clearance",
        "type": "string",
        "enum": [
          "UNCLASSIFIED",
          "CONFIDENTIAL",
          "SECRET",
          "TOP_SECRET"
        ]
      },
      "countryOfAffiliation": {
        "required": true,
        "claim": "countryOfAffiliation",
        "type": "string",
        "format": "ISO-3166-1-alpha-3"
      },
      "uniqueID": {
        "required": true,
        "claim": "uniqueID",
        "type": "string"
      },
      "acpCOI": {
        "required": false,
        "claim": "acpCOI",
        "type": "array",
        "items": {
          "type": "string",
          "enum": [
            "NATO",
            "NATO-COSMIC",
            "FVEY",
            "CAN-US",
            "US-ONLY"
          ]
        }
      }
    }
  },
  "gcp": {
    "projectId": "dive25",
    "region": "us-east4",
    "services": {
      "secretManager": {
        "enabled": true,
        "replicationPolicy": "user-managed",
        "locations": [
          "us-east4"
        ]
      },
      "logging": {
        "enabled": true,
        "retention": "90d"
      },
      "monitoring": {
        "enabled": true,
        "alerting": true
      }
    }
  },
  "monitoring": {
    "prometheus": {
      "port": 9090,
      "scrapeInterval": "30s"
    },
    "grafana": {
      "port": 3333,
      "adminUser": "admin"
    },
    "statusPage": {
      "port": 8888,
      "checkInterval": "60s"
    },
    "blacklistRedis": {
      "port": 6399,
      "network": "dive-v3-shared-network"
    }
  }
}
