# =============================================================================
# DIVE V3 - SECRETS CONFIGURATION
# =============================================================================
# This is the SINGLE SOURCE OF TRUTH for all secrets.
# 
# SETUP:
#   1. Copy this file to .env.secrets
#   2. Generate strong passwords for each value
#   3. NEVER commit .env.secrets to version control
#
# HOW IT WORKS:
#   - docker-compose.yml reads from this file via env_file directive
#   - Terraform reads via TF_VAR_* environment variables
#   - Application .env files reference these variables
#
# PASSWORD GENERATION (use one of these):
#   openssl rand -base64 32
#   uuidgen | tr -d '-'
#   pwgen -s 32 1
# =============================================================================

# -----------------------------------------------------------------------------
# KEYCLOAK ADMIN CREDENTIALS (Keycloak 26+ Standard)
# -----------------------------------------------------------------------------
# Keycloak 26+ uses KC_BOOTSTRAP_ADMIN_* for initial admin user creation
# Hub uses _USA suffix for normalized naming convention (all Hub secrets)
KC_BOOTSTRAP_ADMIN_USERNAME=admin
KC_BOOTSTRAP_ADMIN_PASSWORD_USA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# Legacy variables (deprecated - use KC_BOOTSTRAP_ADMIN_* instead)
# KEYCLOAK_ADMIN_USERNAME=admin
# KEYCLOAK_ADMIN_PASSWORD=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# -----------------------------------------------------------------------------
# DATABASE CREDENTIALS
# -----------------------------------------------------------------------------
# Hub uses _USA suffix for normalized naming convention (all Hub secrets)

# PostgreSQL (Keycloak database)
POSTGRES_USER=postgres
POSTGRES_PASSWORD_USA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# MongoDB (Resource metadata)
MONGO_INITDB_ROOT_USERNAME=admin
MONGO_PASSWORD_USA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# Redis (Token blacklist - shared across Hub and Spokes)
REDIS_PASSWORD_USA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
REDIS_PASSWORD_BLACKLIST=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# Legacy variables (deprecated - use *_USA suffix for Hub)
# POSTGRES_PASSWORD=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
# MONGO_INITDB_ROOT_PASSWORD=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
# REDIS_PASSWORD=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# -----------------------------------------------------------------------------
# APPLICATION SECRETS
# -----------------------------------------------------------------------------
# NextAuth.js secret (for JWT signing)
AUTH_SECRET=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# Keycloak Client Secret (generated by Keycloak, retrieve via admin console)
KEYCLOAK_CLIENT_SECRET=CHANGE_ME_GET_FROM_KEYCLOAK

# -----------------------------------------------------------------------------
# CLOUDFLARE TUNNEL CREDENTIALS
# -----------------------------------------------------------------------------
# Tunnel tokens are stored separately per instance in:
#   - cloudflared/tunnel-credentials.json
#   - instances/{instance}/cloudflared/credentials.json
# These are also gitignored and should be generated via:
#   cloudflared tunnel create <tunnel-name>

# -----------------------------------------------------------------------------
# TERRAFORM VARIABLES (TF_VAR_ prefix auto-maps to Terraform)
# -----------------------------------------------------------------------------
# When you run: source .env.secrets && terraform apply
# Terraform automatically picks up TF_VAR_* as variable values
# Keycloak 26+ uses KC_BOOTSTRAP_ADMIN_PASSWORD_USA
TF_VAR_keycloak_admin_password=${KC_BOOTSTRAP_ADMIN_PASSWORD_USA}

# -----------------------------------------------------------------------------
# INSTANCE-SPECIFIC SECRETS (for multi-instance / spoke deployments)
# -----------------------------------------------------------------------------
# Spoke instances use _{INSTANCE_CODE} suffix (e.g., FRA, GBR, DEU)
# Hub uses _USA suffix for consistency

# FRA Spoke Instance
KC_BOOTSTRAP_ADMIN_PASSWORD_FRA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
KEYCLOAK_CLIENT_SECRET_FRA=CHANGE_ME_GET_FROM_KEYCLOAK_FRA
POSTGRES_PASSWORD_FRA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
MONGO_PASSWORD_FRA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
REDIS_PASSWORD_FRA=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# GBR Spoke Instance
KC_BOOTSTRAP_ADMIN_PASSWORD_GBR=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
KEYCLOAK_CLIENT_SECRET_GBR=CHANGE_ME_GET_FROM_KEYCLOAK_GBR
POSTGRES_PASSWORD_GBR=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
MONGO_PASSWORD_GBR=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
REDIS_PASSWORD_GBR=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# DEU Spoke Instance
KC_BOOTSTRAP_ADMIN_PASSWORD_DEU=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
KEYCLOAK_CLIENT_SECRET_DEU=CHANGE_ME_GET_FROM_KEYCLOAK_DEU
POSTGRES_PASSWORD_DEU=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
MONGO_PASSWORD_DEU=CHANGE_ME_GENERATE_32_CHAR_PASSWORD
REDIS_PASSWORD_DEU=CHANGE_ME_GENERATE_32_CHAR_PASSWORD

# Legacy variables (deprecated - use KC_BOOTSTRAP_ADMIN_PASSWORD_{CODE})
# FRA_KEYCLOAK_CLIENT_SECRET=CHANGE_ME_GET_FROM_KEYCLOAK_FRA
# FRA_POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
# DEU_KEYCLOAK_CLIENT_SECRET=CHANGE_ME_GET_FROM_KEYCLOAK_DEU
# DEU_POSTGRES_PASSWORD=${POSTGRES_PASSWORD}


