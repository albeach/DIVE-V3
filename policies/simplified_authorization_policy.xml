<?xml version="1.0" encoding="UTF-8"?>
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
           PolicySetId="urn:dive:v3:simplified:authorization:policyset"
           PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-overrides"
           Version="1.0">
    
    <Description>
        DIVE V3 Simplified Authorization Policy - XACML 3.0 Representation
        Implements core ABAC rules: Authentication, Clearance, Releasability, COI
        Pattern: Fail-secure with explicit deny conditions
        
        Attribute Name Support (alternative names via PIP/PEP mapping):
        - clearance OR cclr (Subject security clearance level)
        - countryOfAffiliation OR country (Subject country code ISO 3166-1 alpha-3)
        - acpCOI OR aciCOI (Subject Community of Interest tags)
        
        Classification Levels:
        - UNCLASSIFIED (level 0)
        - RESTRICTED (level 0 - equivalent to UNCLASSIFIED)
        - CONFIDENTIAL (level 1)
        - SECRET (level 2)
        - TOP_SECRET (level 3)
        
        Special COIs (no country affiliation required):
        - Alpha: Compartmentalized Special Access Program
        - Beta: Project-based compartment
        - Gamma: Highly compartmentalized SAP
    </Description>
    
    <Target/>
    
    <!-- ============================================ -->
    <!-- Policy 1: Authentication Check -->
    <!-- ============================================ -->
    <Policy PolicyId="urn:dive:v3:policy:authentication"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides"
            Version="1.0">
        
        <Description>Verify subject is authenticated</Description>
        <Target/>
        
        <Rule RuleId="urn:dive:v3:rule:authentication:required" Effect="Deny">
            <Description>Deny if subject is not authenticated</Description>
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-equal">
                        <AttributeDesignator
                            AttributeId="urn:dive:subject:authenticated"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#boolean"
                            MustBePresent="true"/>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <Rule RuleId="urn:dive:v3:rule:default:permit" Effect="Permit">
            <Description>Default permit if authenticated</Description>
        </Rule>
    </Policy>
    
    <!-- ============================================ -->
    <!-- Policy 2: Required Attributes Check -->
    <!-- ============================================ -->
    <Policy PolicyId="urn:dive:v3:policy:required:attributes"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides"
            Version="1.0">
        
        <Description>Verify all required attributes are present</Description>
        <Target/>
        
        <Rule RuleId="urn:dive:v3:rule:uniqueid:required" Effect="Deny">
            <Description>Deny if uniqueID is missing</Description>
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                        <AttributeDesignator
                            AttributeId="urn:dive:subject:uniqueID"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            MustBePresent="false"/>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:uniqueID"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                        </Apply>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <Rule RuleId="urn:dive:v3:rule:clearance:required" Effect="Deny">
            <Description>Deny if clearance OR cclr is missing (supports both attribute names)</Description>
            <Target/>
            <Condition>
                <!-- Deny if BOTH clearance and cclr are missing -->
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:clearance"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="false"/>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
                                <AttributeDesignator
                                    AttributeId="urn:dive:subject:clearance"
                                    Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                            </Apply>
                        </Apply>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:cclr"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="false"/>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
                                <AttributeDesignator
                                    AttributeId="urn:dive:subject:cclr"
                                    Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                            </Apply>
                        </Apply>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <Rule RuleId="urn:dive:v3:rule:country:required" Effect="Deny">
            <Description>Deny if countryOfAffiliation OR country is missing (supports both attribute names)</Description>
            <Target/>
            <Condition>
                <!-- Deny if BOTH countryOfAffiliation and country are missing -->
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:countryOfAffiliation"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="false"/>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
                                <AttributeDesignator
                                    AttributeId="urn:dive:subject:countryOfAffiliation"
                                    Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                            </Apply>
                        </Apply>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:country"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="false"/>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
                                <AttributeDesignator
                                    AttributeId="urn:dive:subject:country"
                                    Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                            </Apply>
                        </Apply>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <Rule RuleId="urn:dive:v3:rule:default:permit" Effect="Permit">
            <Description>Default permit if all attributes present</Description>
        </Rule>
    </Policy>
    
    <!-- ============================================ -->
    <!-- Policy 3: Clearance Level Check -->
    <!-- ============================================ -->
    <!-- NOTE: In production, a PEP/PIP should normalize attribute names -->
    <!-- (clearance OR cclr) to a single canonical form before XACML evaluation -->
    <Policy PolicyId="urn:dive:v3:policy:clearance"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides"
            Version="1.0">
        
        <Description>
            Verify subject clearance is sufficient for resource classification.
            Clearance levels: UNCLASSIFIED/RESTRICTED=0, CONFIDENTIAL=1, SECRET=2, TOP_SECRET=3.
            RESTRICTED is treated as equivalent to UNCLASSIFIED (level 0).
        </Description>
        <Target/>
        
        <!-- Rule: Deny if trying to access TOP_SECRET without TOP_SECRET clearance -->
        <Rule RuleId="urn:dive:v3:rule:clearance:top:secret" Effect="Deny">
            <Description>Deny TOP_SECRET access without TOP_SECRET clearance</Description>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">TOP_SECRET</AttributeValue>
                            <AttributeDesignator
                                AttributeId="urn:dive:resource:classification"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeDesignator
                            AttributeId="urn:dive:subject:clearance"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            MustBePresent="true"/>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">TOP_SECRET</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <!-- Rule: Deny if trying to access SECRET without SECRET or TOP_SECRET clearance -->
        <Rule RuleId="urn:dive:v3:rule:clearance:secret" Effect="Deny">
            <Description>Deny SECRET access without SECRET+ clearance</Description>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">SECRET</AttributeValue>
                            <AttributeDesignator
                                AttributeId="urn:dive:resource:classification"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:clearance"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">SECRET</AttributeValue>
                        </Apply>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:clearance"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">TOP_SECRET</AttributeValue>
                        </Apply>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <!-- Rule: Deny if trying to access CONFIDENTIAL without CONFIDENTIAL+ clearance -->
        <Rule RuleId="urn:dive:v3:rule:clearance:confidential" Effect="Deny">
            <Description>Deny CONFIDENTIAL access without CONFIDENTIAL+ clearance (UNCLASSIFIED or RESTRICTED insufficient)</Description>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">CONFIDENTIAL</AttributeValue>
                            <AttributeDesignator
                                AttributeId="urn:dive:resource:classification"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <!-- Deny if clearance/cclr is UNCLASSIFIED or RESTRICTED (both are level 0) -->
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeDesignator
                            AttributeId="urn:dive:subject:clearance"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            MustBePresent="false"/>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">UNCLASSIFIED</AttributeValue>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeDesignator
                            AttributeId="urn:dive:subject:clearance"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            MustBePresent="false"/>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">RESTRICTED</AttributeValue>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeDesignator
                            AttributeId="urn:dive:subject:cclr"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            MustBePresent="false"/>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">UNCLASSIFIED</AttributeValue>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeDesignator
                            AttributeId="urn:dive:subject:cclr"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            MustBePresent="false"/>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">RESTRICTED</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <Rule RuleId="urn:dive:v3:rule:default:permit" Effect="Permit">
            <Description>Default permit if clearance sufficient</Description>
        </Rule>
    </Policy>
    
    <!-- ============================================ -->
    <!-- Policy 4: Country Releasability Check -->
    <!-- ============================================ -->
    <Policy PolicyId="urn:dive:v3:policy:releasability"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides"
            Version="1.0">
        
        <Description>Verify resource is releasable to subject's country</Description>
        <Target/>
        
        <Rule RuleId="urn:dive:v3:rule:releasability:check" Effect="Deny">
            <Description>Deny if subject country not in releasabilityTo list (checks both countryOfAffiliation and country attributes)</Description>
            <Target/>
            <Condition>
                <!-- Deny if country not in releasabilityTo (check both attribute names) -->
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                    <!-- countryOfAffiliation not in releasabilityTo -->
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:countryOfAffiliation"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="false"/>
                            <AttributeDesignator
                                AttributeId="urn:dive:resource:releasabilityTo"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                        </Apply>
                    </Apply>
                    <!-- country not in releasabilityTo (alternative name) -->
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                            <AttributeDesignator
                                AttributeId="urn:dive:subject:country"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="false"/>
                            <AttributeDesignator
                                AttributeId="urn:dive:resource:releasabilityTo"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="true"/>
                        </Apply>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <Rule RuleId="urn:dive:v3:rule:default:permit" Effect="Permit">
            <Description>Default permit if country releasable</Description>
        </Rule>
    </Policy>
    
    <!-- ============================================ -->
    <!-- Policy 5: Community of Interest (COI) Check -->
    <!-- ============================================ -->
    <Policy PolicyId="urn:dive:v3:policy:coi"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides"
            Version="1.0">
        
        <Description>
            Verify subject has required COI membership (if resource requires COI).
            Special COIs (Alpha, Beta, Gamma) have no country affiliation requirements.
            COI membership is based on exact tag matching - Alpha/Beta/Gamma are mutually exclusive.
            Supports both acpCOI and aciCOI attribute names.
        </Description>
        <Target/>
        
        <Rule RuleId="urn:dive:v3:rule:coi:check" Effect="Deny">
            <Description>Deny if no COI intersection when resource requires COI</Description>
            <Target/>
            <Condition>
                <!-- Complex COI intersection logic - simplified in XACML -->
                <!-- In practice, this would use custom functions or policy information points -->
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
                        <!-- Either resource has no COI requirement -->
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag-size">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                                <AttributeDesignator
                                    AttributeId="urn:dive:resource:COI"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">0</AttributeValue>
                            </Apply>
                        </Apply>
                        <!-- Or user has no COI tags (allowed) - check both acpCOI and aciCOI -->
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag-size">
                                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                                    <AttributeDesignator
                                        AttributeId="urn:dive:subject:acpCOI"
                                        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                        DataType="http://www.w3.org/2001/XMLSchema#string"
                                        MustBePresent="false"/>
                                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">0</AttributeValue>
                                </Apply>
                            </Apply>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag-size">
                                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                                    <AttributeDesignator
                                        AttributeId="urn:dive:subject:aciCOI"
                                        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                        DataType="http://www.w3.org/2001/XMLSchema#string"
                                        MustBePresent="false"/>
                                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">0</AttributeValue>
                                </Apply>
                            </Apply>
                        </Apply>
                        <!-- Or there is at least one COI intersection (check both acpCOI and aciCOI) -->
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of">
                                <AttributeDesignator
                                    AttributeId="urn:dive:subject:acpCOI"
                                    Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                                <AttributeDesignator
                                    AttributeId="urn:dive:resource:COI"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                            </Apply>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of">
                                <AttributeDesignator
                                    AttributeId="urn:dive:subject:aciCOI"
                                    Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                                <AttributeDesignator
                                    AttributeId="urn:dive:resource:COI"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    MustBePresent="false"/>
                            </Apply>
                        </Apply>
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        
        <Rule RuleId="urn:dive:v3:rule:default:permit" Effect="Permit">
            <Description>Default permit if COI satisfied</Description>
        </Rule>
    </Policy>
    
    <!-- ============================================ -->
    <!-- Obligations Section -->
    <!-- ============================================ -->
    <!-- Note: XACML 3.0 obligations would be specified here for KAS integration -->
    <!-- Example obligation for encrypted resources requiring key access service -->
    
    <!-- ============================================ -->
    <!-- XACML Attribute Mapping Notes -->
    <!-- ============================================ -->
    <!--
    PEP/PIP Attribute Normalization (Recommended):
    
    The policy supports multiple attribute naming conventions. For optimal
    performance, the PEP or PIP should normalize attribute names to a canonical
    form before submitting to the PDP:
    
    1. Clearance Normalization:
       - Map both "clearance" and "cclr" → canonical "clearance"
       - Or provide both attributes in the request
    
    2. Country Normalization:
       - Map both "countryOfAffiliation" and "country" → canonical "countryOfAffiliation"
       - Or provide both attributes in the request
    
    3. COI Normalization:
       - Map both "acpCOI" and "aciCOI" → canonical "acpCOI"
       - Or provide both attributes in the request
    
    Example XACML Request with Alternative Attributes:
    
    <Request>
      <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute AttributeId="urn:dive:subject:authenticated">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
        </Attribute>
        <Attribute AttributeId="urn:dive:subject:uniqueID">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">alpha.user@contractor.com</AttributeValue>
        </Attribute>
        <Attribute AttributeId="urn:dive:subject:cclr">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">SECRET</AttributeValue>
        </Attribute>
        <Attribute AttributeId="urn:dive:subject:country">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">USA</AttributeValue>
        </Attribute>
        <Attribute AttributeId="urn:dive:subject:aciCOI">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Alpha</AttributeValue>
        </Attribute>
      </Attributes>
      <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute AttributeId="urn:dive:resource:resourceId">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">doc-alpha-001</AttributeValue>
        </Attribute>
        <Attribute AttributeId="urn:dive:resource:classification">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">SECRET</AttributeValue>
        </Attribute>
        <Attribute AttributeId="urn:dive:resource:releasabilityTo">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">USA</AttributeValue>
        </Attribute>
        <Attribute AttributeId="urn:dive:resource:COI">
          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Alpha</AttributeValue>
        </Attribute>
      </Attributes>
    </Request>
    
    Test Cases Covered:
    - Standard attribute names (clearance, countryOfAffiliation, acpCOI)
    - Alternative attribute names (cclr, country, aciCOI)
    - RESTRICTED classification (level 0, same as UNCLASSIFIED)
    - Alpha/Beta/Gamma COI compartments (mutually exclusive)
    - Authentication, clearance, releasability, and COI checks
    -->
    
</PolicySet>

